<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ingreso PAC | Municipalidad de Arica</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="dir_formularioapps.js"></script>
</head>
    <style>
        /* Reset and base styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, sans-serif;
        }
        
        body {
            background-color: #f5f5f7;
            color: #1d1d1f;
            overflow-x: hidden;
        }
        
        /* Smooth scrolling */
        html {
            scroll-behavior: smooth;
        }
        
        /* Header styles */
        header {
            background-color: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            transition: all 0.4s ease;
        }

        .top-header {
            display: flex;
            justify-content: center; /* Centramos horizontalmente */
            align-items: center;
            padding: 15px 5%;
            max-width: 1400px;
            margin: 0 auto;
            text-align: center;
        }

        .logo {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .logo img {
            height: 40px;
            transition: transform 0.3s ease;
        }

        .logo:hover img {
            transform: scale(1.05);
        }

        .logo-text {
            display: flex;
            flex-direction: column;
            align-items: center; /* Centra el texto debajo del logo */
            margin-left: 0;
        }

        .logo-text h1 {
            font-size: 24px;
            font-weight: 600;
            letter-spacing: -0.5px;
        }

        .logo-text span {
            font-size: 12px;
            font-weight: 400;
            color: #86868b;
        }
        
        /* Dashboard container */
        .dashboard-container {
            padding: 40px 5%;
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .dashboard-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .dashboard-title {
            font-size: 32px;
            font-weight: 600;
            letter-spacing: -0.5px;
        }
        
        .back-button {
            display: flex;
            align-items: center;
            background-color: #f5f5f7;
            border: none;
            border-radius: 100px;
            padding: 10px 20px;
            font-size: 16px;
            font-weight: 500;
            color: #06c;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.3s ease;
        }
        
        .back-button:hover {
            background-color: #e9e9eb;
            transform: translateY(-2px);
        }
        
        .back-icon {
            margin-right: 8px;
        }
        
        /* Carga de archivos estilo moderno */
        .file-upload-container {
            background-color: #3383FF;
            border-radius: 16px;
            padding: 30px;
            text-align: center;
            margin: 30px 0;
            color: white;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
            position: relative;
            transition: all 0.3s ease;
            border: 3px dashed rgba(255, 255, 255, 0.5);
        }
        
        .file-upload-container.drag-active {
            background-color: #2979ff;
            border: 3px dashed white;
            transform: scale(1.01);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
        }
        
        .file-upload-icon {
            margin-bottom: 20px;
        }
        
        .file-upload-icon img {
            width: 80px;
            height: auto;
        }
        
        .file-upload-button {
            background-color: white;
            color: #333;
            border: none;
            border-radius: 6px;
            padding: 15px 30px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            margin: 20px 0;
            transition: all 0.3s ease;
        }
        
        .file-upload-button:hover {
            background-color: #f8f8f8;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .file-upload-help {
            font-size: 15px;
            opacity: 0.9;
            margin-top: 15px;
        }
        
        .upload-options {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 20px;
        }
        
        .upload-option-button {
            padding: 10px 20px;
            border: 1px solid rgba(255, 255, 255, 0.4);
            border-radius: 6px;
            background-color: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .upload-option-button:hover {
            background-color: rgba(255, 255, 255, 0.2);
        }
        
        /* Footer */
        footer {
            background-color: #f5f5f7;
            color: #1d1d1f;
            padding: 60px 5%;
            border-top: 1px solid rgba(0, 0, 0, 0.1);
            margin-top: 60px;
        }
        
        .footer-container {
            display: flex;
            justify-content: space-between;
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .footer-column {
            flex: 1;
            padding: 0 20px;
        }
        
        .footer-column h3 {
            margin-bottom: 20px;
            font-size: 18px;
            font-weight: 600;
        }
        
        .footer-column p {
            margin-bottom: 10px;
            color: #86868b;
            font-size: 14px;
        }
        
        .footer-column ul {
            list-style: none;
        }
        
        .footer-column ul li {
            margin-bottom: 12px;
        }
        
        .footer-column a {
            color: #06c;
            text-decoration: none;
            font-size: 14px;
            transition: opacity 0.3s ease;
        }
        
        .footer-column a:hover {
            opacity: 0.7;
        }
        
        .social-icons {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }
        
        .social-icons a {
            background-color: rgba(0, 0, 0, 0.05);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            transition: transform 0.3s ease, background-color 0.3s ease;
        }
        
        .social-icons a:hover {
            transform: translateY(-3px);
            background-color: rgba(0, 0, 0, 0.1);
        }
        
        .footer-bottom {
            max-width: 1400px;
            margin: 40px auto 0;
            padding-top: 20px;
            border-top: 1px solid rgba(0, 0, 0, 0.1);
            text-align: center;
            font-size: 12px;
            color: #86868b;
        }
        
        /* Assistant chat button */
        .assistant-button {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background-color: rgba(6, 12, 204, 0.9);
            color: white;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);
            cursor: pointer;
            z-index: 100;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .assistant-button:hover {
            transform: scale(1.1);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
        }
        
        /* Responsive design */
        @media (max-width: 992px) {
            .footer-container {
                flex-direction: column;
            }
            
            .footer-column {
                margin-bottom: 40px;
            }
        }
        
        @media (max-width: 768px) {
            .dashboard-title {
                font-size: 24px;
            }
            
            .dashboard-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 15px;
            }
            
            .upload-options {
                flex-direction: column;
                align-items: center;
            }
        }
        
        .custom-btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 12px 28px;
            font-size: 16px;
            font-weight: 600;
            color: #fff;
            background: linear-gradient(135deg, #3356e0, #ee0979);
            border: none;
            border-radius: 999px;
            box-shadow: 0 8px 20px rgba(255, 105, 135, 0.3);
            text-decoration: none;
            transition: all 0.3s ease;
        }

        .custom-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(255, 105, 135, 0.5);
        }

        .arrow {
            margin-left: 10px;
            font-size: 18px;
            transition: transform 0.3s ease;
        }

        .custom-btn:hover .arrow {
            transform: translateX(4px);
        }
        
        /* Bot√≥n para modificar Excel */
        .modify-excel-btn {
            background: linear-gradient(135deg, #06c, #09c);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 14px 28px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            margin-top: 20px;
            display: inline-block;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0, 102, 204, 0.3);
        }
        
        .modify-excel-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0, 102, 204, 0.4);
            background: linear-gradient(135deg, #0066cc, #0088dd);
        }
        
        /* Contenedor de instrucciones */
        .instructions-container {
            background-color: white;
            border-radius: 12px;
            padding: 25px;
            margin: 30px 0;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        }
        
        .instructions-container h3 {
            font-size: 22px;
            margin-bottom: 15px;
            color: #333;
        }
        
        .instructions-container ol {
            padding-left: 20px;
            margin-bottom: 15px;
        }
        
        .instructions-container li {
            margin-bottom: 10px;
            line-height: 1.6;
        }
        
        .instructions-container .note {
            background-color: rgba(0, 102, 204, 0.1);
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #06c;
            margin-top: 15px;
        }
    </style>
</head>
<body>
       <!-- Header with logo -->
       <header>
        <div class="top-header">
            <div class="logo">
                <img src="logo_MUNI.png" alt="Logo Municipalidad de Arica">
                <div class="logo-text">
                    <h1>ARICA</h1>
                    <span>MUNICIPALIDAD | mejor ciudad</span>
                </div>
            </div>
        </div>
    </header>
    
    <!-- Main content section -->
    <section class="dashboard-container">
        <div class="dashboard-header">
            <h2 class="dashboard-title">Ingreso PAC - Presupuesto Anual de Compra</h2>
            <button class="back-button" onclick="window.location.href='formulario-1.html'">
                <span class="back-icon">‚Üê</span> Volver 
            </button>
        </div>
        
        <!-- Selector de a√±o - AGREGADO -->
        <div style="margin-bottom: 20px;">
            <label for="numAnio" style="font-weight: 600; margin-right: 10px;">A√±o del PAC:</label>
            <select id="numAnio" style="padding: 8px 12px; border-radius: 6px; border: 1px solid #ccc; font-size: 16px;">
                <!-- Se llenar√° con JavaScript -->
            </select>
        </div>
        
        <!-- Contenedor de carga de archivos estilo moderno -->
        <div id="dropZone" class="file-upload-container">
            <div class="file-upload-icon">
                <img src="ms-excel.png" alt="Icono de Excel">
            </div>
            <h2>Carga tu archivo Excel para PAC</h2>
            <p id="uploadHelpText" class="file-upload-help">Arrastra y suelta tu archivo Excel o haz clic para seleccionarlo</p>
            
            <input type="file" id="excelFile" accept=".xls,.xlsx" style="display: none;">
            <button class="file-upload-button" onclick="document.getElementById('excelFile').click()">
                ELEGIR ARCHIVO
            </button>
            <p id="selectedFileName" style="margin-top: 10px;">No se ha seleccionado ning√∫n archivo</p>
            
            <div id="uploadProgress" style="width: 80%; margin: 15px auto; display: none;">
                <div style="background-color: rgba(255,255,255,0.3); height: 10px; border-radius: 5px; overflow: hidden;">
                    <div id="progressBar" style="background-color: white; height: 100%; width: 0%; transition: width 0.3s ease;"></div>
                </div>
                <p id="progressText" style="margin-top: 5px; font-size: 14px;">Procesando...</p>
            </div>
            
            <div class="upload-options">
                <button id="uploadBtn" class="file-upload-button" style="background-color: #4CAF50; margin-right: 10px; display: none;">
                    PROCESAR ARCHIVO
                </button>
                <button class="modify-excel-btn" onclick="descargarPlantilla()"> Descargar Plantilla PAC </button>
            </div>
        </div>
        
        <!-- Mensaje Toast para notificaciones -->
        <div id="toast1" style="visibility: hidden; position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%); background-color: #333; color: white; text-align: center; border-radius: 5px; padding: 16px; z-index: 1000; min-width: 250px; opacity: 0; transition: opacity 0.3s ease;">
            Mensaje de notificaci√≥n
        </div>
        
        <!-- Instrucciones -->
        <div class="instructions-container">
            <h3>Instrucciones para la carga del PAC</h3>
            <ol>
                <li>Seleccione el a√±o para el cual est√° registrando el PAC.</li>
                <li>Prepare su archivo Excel con el formato establecido para el Presupuesto Anual de Compra.</li>
                <li>Aseg√∫rese de que todas las columnas requeridas est√©n correctamente completadas.</li>
                <li>Haga clic en "ELEGIR ARCHIVO" para seleccionar su archivo desde su computadora.</li>
                <li>Una vez seleccionado, puede verificar el nombre del archivo antes de continuar.</li>
                <li>Si necesita el formato oficial del PAC, utilice el bot√≥n "Descargar Plantilla PAC".</li>
                <li>Para cargar el archivo, haga clic en "PROCESAR ARCHIVO" despu√©s de haber seleccionado el archivo.</li>
            </ol>
            
            <div class="note">
                <strong>Nota importante:</strong> El sistema solo acepta archivos en formato Excel (.xls, .xlsx). Aseg√∫rese de seguir la plantilla oficial para evitar errores en el procesamiento.
            </div>
        </div>
    </section>
   
    <!-- Bot√≥n para modificar PAC con sistema de contrase√±a -->
<div class="upload-options" style="display: flex; justify-content: center; margin-top: 30px;">
    <button id="modifyPacBtn" class="modify-excel-btn">Modificar PAC</button>
</div>

<!-- Modal de contrase√±a (oculto por defecto) -->
<div id="passwordModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.7); z-index: 1000; justify-content: center; align-items: center;">
    <div style="background-color: white; padding: 30px; border-radius: 12px; box-shadow: 0 5px 20px rgba(0,0,0,0.3); width: 90%; max-width: 400px;">
        <h3 style="margin-bottom: 20px; font-size: 20px; text-align: center;">Acceso Restringido</h3>
        
        <p style="margin-bottom: 15px; text-align: center;">Ingrese la contrase√±a para modificar el PAC:</p>
        
        <div style="margin-bottom: 20px;">
            <input type="password" id="passwordInput" style="width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 6px; font-size: 16px;" placeholder="Contrase√±a">
        </div>
        
        <div id="passwordError" style="color: #e74c3c; margin-bottom: 15px; text-align: center; display: none;">
            Contrase√±a incorrecta. Int√©ntelo nuevamente.
        </div>
        
        <div style="display: flex; justify-content: space-between;">
            <button id="cancelPasswordBtn" style="background-color: #e0e0e0; border: none; border-radius: 6px; padding: 10px 20px; cursor: pointer;">Cancelar</button>
            <button id="submitPasswordBtn" style="background: linear-gradient(135deg, #06c, #09c); color: white; border: none; border-radius: 6px; padding: 10px 20px; font-weight: 600; cursor: pointer;">Acceder</button>
        </div>
    </div>
</div>
</section>
<!-- Script para el sistema de contrase√±a -->
<script>
    // Configuraci√≥n - Cambia esta contrase√±a por la que desees usar
    const CORRECT_PASSWORD = "muni2025"; // Esta es la contrase√±a que deber√°n ingresar
    
    // Referencias a elementos DOM
    const modifyPacBtn = document.getElementById('modifyPacBtn');
    const passwordModal = document.getElementById('passwordModal');
    const passwordInput = document.getElementById('passwordInput');
    const submitPasswordBtn = document.getElementById('submitPasswordBtn');
    const cancelPasswordBtn = document.getElementById('cancelPasswordBtn');
    const passwordError = document.getElementById('passwordError');
    
    // Mostrar modal al hacer clic en el bot√≥n
    modifyPacBtn.addEventListener('click', function() {
        // Resetear input y error
        passwordInput.value = "";
        passwordError.style.display = "none";
        
        // Mostrar modal
        passwordModal.style.display = "flex";
        
        // Enfocar en el input
        setTimeout(() => passwordInput.focus(), 100);
    });
    
    // Cerrar modal al hacer clic en Cancelar
    cancelPasswordBtn.addEventListener('click', function() {
        passwordModal.style.display = "none";
    });
    
    // Validar contrase√±a al hacer clic en Acceder
    submitPasswordBtn.addEventListener('click', validatePassword);
    
    // Tambi√©n validar al presionar Enter en el input
    passwordInput.addEventListener('keyup', function(event) {
        if (event.key === "Enter") {
            validatePassword();
        }
    });
    
    // Funci√≥n para validar la contrase√±a
    function validatePassword() {
        const enteredPassword = passwordInput.value.trim();
        
        if (enteredPassword === CORRECT_PASSWORD) {
            // Contrase√±a correcta - redirigir a la p√°gina
            passwordModal.style.display = "none";
            window.location.href = 'modificarpac.html';
        } else {
            // Contrase√±a incorrecta - mostrar error
            passwordError.style.display = "block";
            passwordInput.value = "";
            passwordInput.focus();
            
            // Efecto de vibraci√≥n suave para indicar error
            passwordInput.style.animation = "shake 0.5s";
            setTimeout(() => {
                passwordInput.style.animation = "";
            }, 500);
        }
    }
    
    // Cerrar modal si se hace clic fuera de la ventana
    passwordModal.addEventListener('click', function(event) {
        if (event.target === passwordModal) {
            passwordModal.style.display = "none";
        }
    });
    
    // A√±adir animaci√≥n de vibraci√≥n para el efecto de error
    const styleElement = document.createElement('style');
    styleElement.innerHTML = `
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
            20%, 40%, 60%, 80% { transform: translateX(5px); }
        }
    `;
    document.head.appendChild(styleElement);
</script>
    
    <!-- Footer -->
    <footer>
        <div class="footer-container">
            <div class="footer-column">
                <h3>Municipalidad de Arica</h3>
                <p>Renato Rocca, Arica</p>
                <p>Anexo: 6959</p>
                <p>Email: roberto.mamani@municipalidadarica.cl</p>
                <div class="social-icons">
                    <a href="#">üìò</a>
                    <a href="#">üì±</a>
                    <a href="#">üê¶</a>
                    <a href="#">üì∏</a>
                </div>
            </div>
            <div class="footer-column">
                <h3>Colaboraci√≥n Interdepartamental</h3>
                <p style="line-height: 1.6;">
                    Este proyecto surge con el prop√≥sito de fortalecer la colaboraci√≥n entre diversas √°reas municipales, como <strong>iluminaci√≥n p√∫blica</strong>, <strong>Of. Mantenimiento de Veh√≠culos y Maquinaria</strong>, <strong>Aseo y Ornato</strong>, <strong>Asesor√≠a Tecnica</strong> y m√°s, en un solo sistema integral. 
                    Buscando consolidar la informaci√≥n y los procesos en un solo sistema, permitiendo un <strong>mayor control operativo</strong>, <strong>gesti√≥n por √°reas</strong> y una visi√≥n integral para la <strong>mejora continua de los servicios municipales</strong>.
                </p>
            </div>
        </div>
        <div class="footer-bottom">
            <p>¬© 2025 Municipalidad de Arica. Todos los derechos reservados.</p>
            <p>Desarrollado por Junior Barrera</p>
        </div>
    </footer>
    
    <!-- Assistance button -->
    <div class="assistant-button" onclick="openAssistance()">üí¨</div>
    
    <script>
const _0x12dc55=_0x1874;(function(_0x54c63e,_0x1d8f48){const _0x41fc69=_0x1874,_0x1e52c6=_0x54c63e();while(!![]){try{const _0x6eda56=parseInt(_0x41fc69(0x154))/0x1+parseInt(_0x41fc69(0x172))/0x2+-parseInt(_0x41fc69(0x12e))/0x3*(parseInt(_0x41fc69(0x150))/0x4)+-parseInt(_0x41fc69(0x182))/0x5+-parseInt(_0x41fc69(0x152))/0x6*(-parseInt(_0x41fc69(0x10f))/0x7)+parseInt(_0x41fc69(0x15c))/0x8*(parseInt(_0x41fc69(0x108))/0x9)+-parseInt(_0x41fc69(0x163))/0xa;if(_0x6eda56===_0x1d8f48)break;else _0x1e52c6['push'](_0x1e52c6['shift']());}catch(_0x45507f){_0x1e52c6['push'](_0x1e52c6['shift']());}}}(_0x31b9,0xe2760));const _0x440c87=_0x32fd;(function(_0x5e9a07,_0x726788){const _0x77d257=_0x1874,_0x52becc=_0x32fd,_0x5691ee=_0x5e9a07();while(!![]){try{const _0xae84bd=parseInt(_0x52becc(0xc4))/0x1*(-parseInt(_0x52becc(0x123))/0x2)+-parseInt(_0x52becc(0x120))/0x3*(-parseInt(_0x52becc(0x134))/0x4)+parseInt(_0x52becc(0x144))/0x5+parseInt(_0x52becc(0xa3))/0x6*(-parseInt(_0x52becc(0xf9))/0x7)+-parseInt(_0x52becc(0x12b))/0x8+parseInt(_0x52becc(0xa8))/0x9*(-parseInt(_0x52becc(0xd3))/0xa)+parseInt(_0x52becc(0xd2))/0xb*(parseInt(_0x52becc(0xed))/0xc);if(_0xae84bd===_0x726788)break;else _0x5691ee[_0x77d257(0x12f)](_0x5691ee[_0x77d257(0x11f)]());}catch(_0x844ec){_0x5691ee[_0x77d257(0x12f)](_0x5691ee[_0x77d257(0x11f)]());}}}(_0x6614,0x9015d));const WEB_APP_URL=dir_pac;var dexce9=new Array(),dexcel=new Array(),separa5='/',gast0=_0x12dc55(0x17e);document[_0x440c87(0x121)](_0x12dc55(0x183),function(){initYearSelector(),setupDragAndDrop(),setupFileInput(),setupUploadButton();});function initYearSelector(){const _0xfdd559=_0x12dc55,_0x2dd2d3=_0x440c87,_0x332040=document[_0x2dd2d3(0xa2)](_0x2dd2d3(0xac)),_0x526854=new Date()[_0x2dd2d3(0xfd)]();_0x332040[_0xfdd559(0x187)]='';for(let _0x33b309=0x0;_0x33b309<0x5;_0x33b309++){const _0x5565f9=_0x526854+_0x33b309;let _0x63b5b6=document[_0x2dd2d3(0x14a)](_0x2dd2d3(0xc9));_0x63b5b6[_0x2dd2d3(0xd5)]=_0x5565f9[_0x2dd2d3(0x125)](),_0x63b5b6[_0x2dd2d3(0xff)]=_0x5565f9[_0x2dd2d3(0x125)](),_0x332040[_0x2dd2d3(0xc7)](_0x63b5b6);}_0x332040[_0x2dd2d3(0xd5)]=_0x526854[_0xfdd559(0x15d)](),_0x332040[_0x2dd2d3(0x121)]('change',resetFileInput);}function setupDragAndDrop(){const _0x70685f=_0x12dc55,_0x2b8235=_0x440c87,_0xfb7118=document[_0x2b8235(0xa2)](_0x2b8235(0xa5)),_0x41d40b=document[_0x2b8235(0xa2)](_0x2b8235(0x129));[_0x2b8235(0xf8),_0x2b8235(0x101),_0x2b8235(0xe7),_0x2b8235(0xbf)][_0x70685f(0x1a0)](_0x2a505a=>{const _0x24df87=_0x2b8235;_0xfb7118[_0x24df87(0x121)](_0x2a505a,_0x302177,![]);}),[_0x2b8235(0xf8),_0x2b8235(0x101)][_0x2b8235(0x124)](_0x189bdc=>{const _0x13e7a3=_0x2b8235;_0xfb7118[_0x13e7a3(0x121)](_0x189bdc,_0x1acfb1,![]);}),[_0x2b8235(0xe7),_0x2b8235(0xbf)][_0x2b8235(0x124)](_0x50831a=>{const _0x3e3103=_0x2b8235;_0xfb7118[_0x3e3103(0x121)](_0x50831a,_0x129033,![]);}),_0xfb7118[_0x2b8235(0x121)](_0x2b8235(0xbf),_0x5ea354,![]);function _0x302177(_0x581b76){const _0x2d22b6=_0x2b8235;_0x581b76[_0x2d22b6(0x10b)](),_0x581b76[_0x2d22b6(0xf4)]();}function _0x1acfb1(){const _0x4f8642=_0x2b8235;_0xfb7118[_0x4f8642(0xda)][_0x4f8642(0x10d)](_0x4f8642(0xfe)),document[_0x4f8642(0xa2)]('uploadHelpText')['textContent']=_0x4f8642(0x13b);}function _0x129033(){const _0x2347b0=_0x2b8235;_0xfb7118[_0x2347b0(0xda)][_0x2347b0(0x11e)](_0x2347b0(0xfe)),document[_0x2347b0(0xa2)](_0x2347b0(0xc3))[_0x2347b0(0x10e)]=_0x2347b0(0x138);}function _0x5ea354(_0x1bb693){const _0x36c083=_0x70685f,_0x143b1b=_0x2b8235,_0x54c8a8=_0x1bb693[_0x36c083(0x198)],_0x3f667e=_0x54c8a8['files'];if(_0x3f667e[_0x143b1b(0xc0)]>0x0){const _0xa36f5f=_0x3f667e[0x0];if(_0xa36f5f[_0x143b1b(0x111)][_0x36c083(0x193)](/\.(xls|xlsx)$/i)){const _0x15c99a=new DataTransfer();_0x15c99a[_0x143b1b(0x106)][_0x143b1b(0x10d)](_0xa36f5f),_0x41d40b[_0x36c083(0x16a)]=_0x15c99a['files'],document[_0x143b1b(0xa2)](_0x143b1b(0x10c))[_0x143b1b(0x10e)]=_0xa36f5f[_0x36c083(0x134)],document[_0x143b1b(0xa2)](_0x143b1b(0x130))[_0x143b1b(0xb4)][_0x143b1b(0xe2)]=_0x143b1b(0x135),showUploadSuccess();}else document[_0x143b1b(0xa2)](_0x36c083(0x162))[_0x143b1b(0x10e)]=_0x143b1b(0xef),document[_0x143b1b(0xa2)](_0x143b1b(0x130))['style'][_0x143b1b(0xe2)]=_0x36c083(0x147);}}}function _0x1874(_0x2fde6d,_0x27e01f){const _0x31b972=_0x31b9();return _0x1874=function(_0x1874d8,_0x17cc3c){_0x1874d8=_0x1874d8-0x106;let _0x2eb376=_0x31b972[_0x1874d8];return _0x2eb376;},_0x1874(_0x2fde6d,_0x27e01f);}function setupFileInput(){const _0x3a2751=_0x440c87,_0x44406c=document[_0x3a2751(0xa2)](_0x3a2751(0x129)),_0xbef845=document[_0x3a2751(0xa2)](_0x3a2751(0x130)),_0x5cee9c=document[_0x3a2751(0xa2)](_0x3a2751(0x10c));_0x44406c[_0x3a2751(0x121)](_0x3a2751(0x122),function(_0x2fbcad){const _0x504989=_0x1874,_0x552924=_0x3a2751,_0x343c12=_0x2fbcad[_0x552924(0x116)][_0x552924(0xf0)][0x0];_0x343c12?_0x343c12[_0x552924(0x111)][_0x552924(0xe6)](/\.(xls|xlsx)$/i)?(_0x5cee9c[_0x552924(0x10e)]=_0x343c12[_0x552924(0x111)],showUploadSuccess(),_0xbef845[_0x552924(0xb4)][_0x552924(0xe2)]=_0x552924(0x135)):(_0x5cee9c[_0x552924(0x10e)]=_0x552924(0xef),_0x5cee9c[_0x504989(0x167)][_0x552924(0xae)]=_0x552924(0xdb),this[_0x552924(0xd5)]='',_0xbef845[_0x552924(0xb4)]['display']=_0x504989(0x147)):(_0x5cee9c[_0x552924(0x10e)]=_0x552924(0x112),_0xbef845[_0x552924(0xb4)]['display']=_0x552924(0xad));});}function setupUploadButton(){const _0x33051f=_0x12dc55,_0x57a184=_0x440c87;document[_0x57a184(0xa2)](_0x57a184(0x130))[_0x33051f(0x18b)](_0x57a184(0x13f),function(){const _0x3fcb89=_0x33051f,_0x2f7634=_0x57a184,_0x3aa253=document[_0x2f7634(0xa2)](_0x3fcb89(0x137))[_0x2f7634(0xf0)][0x0];if(!_0x3aa253){mostrarToast(_0x2f7634(0xc1),_0x2f7634(0xa7));return;}const _0xb8e5a=document[_0x3fcb89(0x16d)](_0x2f7634(0xd6)),_0x4fb0bb=document[_0x2f7634(0xa2)]('progressBar'),_0x5d22f7=document[_0x2f7634(0xa2)](_0x2f7634(0x14c));_0xb8e5a['style']['display']=_0x2f7634(0xb3),_0x4fb0bb[_0x2f7634(0xb4)]['width']='0%',_0x5d22f7[_0x2f7634(0x10e)]=_0x3fcb89(0x13e),procesarArchivoExcel(_0x3aa253,_0x4fb0bb,_0x5d22f7);});}function procesarArchivoExcel(_0x468473,_0x3f1e89,_0xff3d71){const _0x2cb3f4=_0x440c87,_0x58c7bb=new FileReader();_0x58c7bb['onload']=function(_0x4a41ce){const _0x430894=_0x1874,_0x67de8d=_0x32fd;try{_0x3f1e89[_0x67de8d(0xb4)][_0x67de8d(0x117)]=_0x67de8d(0x115),_0xff3d71[_0x67de8d(0x10e)]=_0x67de8d(0x141);const _0x498d07=new Uint8Array(_0x4a41ce[_0x67de8d(0x116)][_0x67de8d(0xcd)]),_0x149611=XLSX[_0x67de8d(0xfa)](_0x498d07,{'type':_0x67de8d(0xf3)});if(_0x149611[_0x67de8d(0xcc)][_0x430894(0x149)]===0x0)throw new Error(_0x430894(0x158));_0x3f1e89[_0x67de8d(0xb4)][_0x67de8d(0x117)]=_0x67de8d(0x10a),_0xff3d71[_0x67de8d(0x10e)]=_0x67de8d(0xcb);const _0x3cb763=_0x149611[_0x67de8d(0xcc)][0x0],_0xc8a8fc=_0x149611[_0x430894(0x159)][_0x3cb763];if(!_0xc8a8fc[_0x67de8d(0xa9)])throw new Error('La\x20hoja\x20Excel\x20est√°\x20vac√≠a');const _0x39db4b=XLSX[_0x67de8d(0xb0)][_0x67de8d(0x12c)](_0xc8a8fc,{'header':0x1});if(_0x39db4b[_0x430894(0x149)]<=0x1)throw new Error(_0x67de8d(0x142));dexce9=crearMatrizUniforme(_0x39db4b),_0x3f1e89['style'][_0x67de8d(0x117)]=_0x67de8d(0x12e),_0xff3d71[_0x430894(0x113)]=_0x67de8d(0xe9),procesarDatosExcel(),_0x3f1e89[_0x67de8d(0xb4)][_0x67de8d(0x117)]=_0x67de8d(0x10f),_0xff3d71[_0x67de8d(0x10e)]=_0x67de8d(0xf6),setTimeout(()=>{const _0x1b063c=_0x430894,_0x562182=_0x67de8d;document[_0x562182(0xa2)](_0x1b063c(0x10b))[_0x562182(0xb4)][_0x562182(0xe2)]=_0x562182(0xad),mostrarToast(_0x562182(0x14b),_0x562182(0xbe));},0x3e8);}catch(_0x2f4c5d){handleProcessingError(_0x2f4c5d);}},_0x58c7bb[_0x2cb3f4(0xe1)]=function(_0x24996a){handleProcessingError(_0x24996a);},_0x58c7bb[_0x2cb3f4(0xbb)](_0x468473);}function crearMatrizUniforme(_0x3238d0){const _0x1c21c1=_0x440c87;if(!_0x3238d0||_0x3238d0[_0x1c21c1(0xc0)]===0x0)throw new Error(_0x1c21c1(0xe8));const _0xf8dc44=Math[_0x1c21c1(0xa4)](..._0x3238d0[_0x1c21c1(0xba)](_0x41213e=>_0x41213e?_0x41213e[_0x1c21c1(0xc0)]:0x0));return _0x3238d0[_0x1c21c1(0xba)](_0x309ec6=>{const _0x1fccd7=_0x1c21c1;if(!_0x309ec6)return Array(_0xf8dc44+0x1)[_0x1fccd7(0x131)]('');const _0xa1ef31=[..._0x309ec6];while(_0xa1ef31[_0x1fccd7(0xc0)]<_0xf8dc44+0x1){_0xa1ef31[_0x1fccd7(0x12a)]('');}return _0xa1ef31;});}function procesarDatosExcel(){const _0x5f032f=_0x12dc55,_0x5c40a9=_0x440c87;console[_0x5c40a9(0x118)](_0x5c40a9(0xb2)),dexcel=[];if(!dexce9||dexce9['length']<=0x1){mostrarToast(_0x5c40a9(0x107),_0x5c40a9(0xa7));throw new Error(_0x5c40a9(0x13d));}const _0x1483db=dexce9[0x0];if(verificarEncabezados(_0x1483db)){mostrarToast(_0x5f032f(0x19c),_0x5c40a9(0xa7));throw new Error(_0x5c40a9(0x11d));}var _0x3ff5f4=[_0x5f032f(0x14d),_0x5c40a9(0xca),_0x5c40a9(0xca),_0x5c40a9(0xca),_0x5c40a9(0x13c),_0x5c40a9(0x13c),_0x5f032f(0x17a),_0x5c40a9(0x13c),_0x5c40a9(0x13c),_0x5c40a9(0xca),_0x5c40a9(0xca),_0x5c40a9(0xca),_0x5c40a9(0x13c),_0x5c40a9(0xca),_0x5f032f(0x17a),_0x5c40a9(0xca),_0x5c40a9(0xca),_0x5c40a9(0xca),_0x5c40a9(0xca),_0x5c40a9(0xca)];const _0x8f777c=dexce9[_0x5c40a9(0x105)](0x1),_0x28f48a=_0x8f777c[0x0][_0x5c40a9(0xc0)];console[_0x5f032f(0x136)](_0x5c40a9(0xb6),_0x8f777c[_0x5c40a9(0xc0)]);for(let _0x3cd5ef=0x0;_0x3cd5ef<_0x8f777c[_0x5c40a9(0xc0)];_0x3cd5ef++){var _0x419980=[..._0x8f777c[_0x3cd5ef]];if(_0x419980[0x0]&&_0x419980[0x0]!==''){console[_0x5c40a9(0x118)](_0x5c40a9(0xe0),_0x3cd5ef+0x1);for(let _0x2b864a=0x0;_0x2b864a<_0x28f48a;_0x2b864a++){(_0x419980[_0x2b864a]===undefined||_0x419980[_0x2b864a]===null)&&(_0x419980[_0x2b864a]='');if(_0x2b864a<_0x3ff5f4[_0x5c40a9(0xc0)]){_0x3ff5f4[_0x2b864a]===_0x5c40a9(0xca)&&(_0x419980[_0x2b864a]=String(_0x419980[_0x2b864a])[_0x5c40a9(0xc8)]());if(_0x3ff5f4[_0x2b864a]===_0x5f032f(0x17a)){let _0x2f4943=String(_0x419980[_0x2b864a])[_0x5c40a9(0x147)](/\./g,'')[_0x5c40a9(0x147)](/\D/g,'');_0x419980[_0x2b864a]=_0x2f4943||'0';}}}const _0x50213a=[document[_0x5c40a9(0xa2)](_0x5c40a9(0xac))[_0x5c40a9(0xd5)],..._0x419980];dexcel[_0x5c40a9(0x12a)](_0x50213a);}}UU=0x0,console[_0x5c40a9(0x118)](_0x5c40a9(0xc5),dexcel[_0x5c40a9(0xc0)],_0x5c40a9(0xf1));if(dexcel[_0x5c40a9(0xc0)]===0x0){mostrarToast(_0x5c40a9(0xe5),_0x5c40a9(0xa7));throw new Error(_0x5c40a9(0xc2));}enviarDatos(_0x5c40a9(0xd9),0x0,dexcel,0x2);}function _0x31b9(){const _0x50dfb4=['guardarPAC','visible','!ref','hidden','248660WvXAgo','¬°Suelta\x20el\x20archivo\x20para\x20cargarlo!','9ajWdYZ','‚ö†Ô∏è\x20El\x20archivo\x20debe\x20ser\x20Excel\x20(.xls\x20o\x20.xlsx)','3TnHDIg','uploadProgress','array','5654810XHyBde','onerror','638393PtlQlP','No\x20hay\x20datos\x20v√°lidos\x20en\x20el\x20archivo','toast1','SheetNames','textContent','datos','Datos\x20recibidos:','Error\x20al\x20generar\x20la\x20plantilla:','form','Datos\x20PAC\x20enviados\x20exitosamente\x20üéâ','Tipo\x20compra','UNIDAD','El\x20archivo\x20Excel\x20no\x20contiene\x20suficientes\x20datos','drop','https://wa.me/','preventDefault','shift','DESCRICI√ìN\x20DE\x20LA\x20CUENTA','Monto','some','dragenter','trim','stringify','smooth','Cantidad','readAsArrayBuffer','target','value','Comentario','type','DESCRIPCI√ìN','2466627csARHy','push','789848trMSbT','text','includes','Distribuci√≥n\x20regional','name','no-cors','log','excelFile','remove','¬°Procesamiento\x20completo!','filas','Archivo\x20procesado\x20correctamente','Producto\x20o\x20Servicio','message','Procesando\x20archivo...','Error\x20del\x20servidor:\x20','stopPropagation','60%','#27ae60','click','option','body','Error\x20al\x20enviar\x20datos:','none','Por\x20favor\x20seleccione\x20un\x20archivo\x20Excel','length','Arrastra\x20y\x20suelta\x20tu\x20archivo\x20Excel\x20o\x20haz\x20clic\x20para\x20seleccionarlo','inline-flex','PAC','txt','N√∫mero\x20de\x20filas\x20a\x20procesar:','No\x20se\x20encontraron\x20datos\x20v√°lidos\x20en\x20el\x20archivo\x20Excel','4DJegpD','uploadHelpText','36IViCPq','method','1069234fWhsQs','width','11WZFqBd','#3383FF','El\x20archivo\x20Excel\x20no\x20contiene\x20hojas','Sheets','Cantidad\x20OC','Generando\x20plantilla\x20PAC...','12554072jxdCZk','toString','Total\x20√çtem','backgroundColor','progressText','Meses\x20env√≠o\x20OC','selectedFileName','18764550unfRWz','C√≥d.\x20tipo\x20compra','Error\x20al\x20procesar\x20el\x20archivo:','removeChild','style','Procesando\x20datos\x20del\x20Excel...','error','files','7TEgemE','numAnio','getElementById','80%','dragleave','2191998vwKeZV','book_new','3413796PYDKMV','‚úÖ\x20¬°Archivo\x20listo\x20para\x20procesar!','createElement','5587236EeWlMG','writeFile','Mes\x20publicaci√≥n','Plantilla_PAC.xlsx','add','num','56959414178','Preparando\x20datos...','toUpperCase','0/0/0/0/0/0/0/0/0/0','input','18BVUtke','C√≥d.\x20Gasto\x20Presupuestario','6331685RFQEvu','DOMContentLoaded','map','Leyendo\x20datos...','change','innerHTML','fill','#e74c3c','100%','addEventListener','Error\x20al\x20procesar\x20el\x20archivo\x20Excel:\x20','block','open','Plantilla\x20PAC','No\x20hay\x20datos\x20en\x20el\x20archivo\x20Excel','color','read','match','then','scrollTo','book_append_sheet','opacity','dataTransfer','every','max','display','El\x20formato\x20del\x20archivo\x20no\x20es\x20correcto.\x20Verifique\x20que\x20sea\x20una\x20plantilla\x20PAC\x20v√°lida.','submit','No\x20se\x20ha\x20seleccionado\x20ning√∫n\x20archivo','5846920CmIrcg','forEach','SOLICITUD','Procesando\x20datos...'];_0x31b9=function(){return _0x50dfb4;};return _0x31b9();}function _0x6614(){const _0x3ca649=_0x12dc55,_0x10824f=[_0x3ca649(0x11b),_0x3ca649(0x19d),_0x3ca649(0x10d),_0x3ca649(0x181),_0x3ca649(0x117),'replace',_0x3ca649(0x1a3),_0x3ca649(0x12b),_0x3ca649(0x174),_0x3ca649(0x13b),_0x3ca649(0x160),_0x3ca649(0x16d),_0x3ca649(0x170),_0x3ca649(0x19a),'dropZone',_0x3ca649(0x197),_0x3ca649(0x189),_0x3ca649(0x180),_0x3ca649(0x1a5),'#3498db',_0x3ca649(0x1a6),_0x3ca649(0x16c),'none',_0x3ca649(0x191),_0x3ca649(0x18e),'utils',_0x3ca649(0x118),_0x3ca649(0x168),_0x3ca649(0x18d),_0x3ca649(0x167),'#4CAF50',_0x3ca649(0x14e),_0x3ca649(0x11d),_0x3ca649(0x161),'Asignaci√≥n\x20Presupuestaria',_0x3ca649(0x184),_0x3ca649(0x128),'Intentando\x20enviar\x20datos\x20con\x20m√©todo\x20alternativo...',_0x3ca649(0x119),_0x3ca649(0x142),_0x3ca649(0x11c),'length',_0x3ca649(0x148),'No\x20hay\x20datos\x20v√°lidos\x20despu√©s\x20del\x20procesamiento',_0x3ca649(0x151),'9MVjTOS','Datos\x20procesados:',_0x3ca649(0x177),'appendChild',_0x3ca649(0x124),_0x3ca649(0x144),_0x3ca649(0x14d),_0x3ca649(0x17c),_0x3ca649(0x112),'result',_0x3ca649(0x164),_0x3ca649(0x13d),_0x3ca649(0x18c),_0x3ca649(0x17f),_0x3ca649(0x156),_0x3ca649(0x106),'Respuesta\x20del\x20servidor:',_0x3ca649(0x12a),_0x3ca649(0x10b),_0x3ca649(0x127),_0x3ca649(0x125),_0x3ca649(0x14c),'classList','#ffcccb',_0x3ca649(0x153),_0x3ca649(0x194),_0x3ca649(0x121),_0x3ca649(0x135),'Procesando\x20fila:',_0x3ca649(0x10e),_0x3ca649(0x19b),_0x3ca649(0x178),_0x3ca649(0x157),_0x3ca649(0x14f),_0x3ca649(0x193),_0x3ca649(0x16f),_0x3ca649(0x190),_0x3ca649(0x1a2),_0x3ca649(0x195),_0x3ca649(0x15b),'visibility',_0x3ca649(0x175),'Error\x20al\x20generar\x20la\x20plantilla:\x20',_0x3ca649(0x109),_0x3ca649(0x16a),_0x3ca649(0x13a),_0x3ca649(0x196),_0x3ca649(0x10c),_0x3ca649(0x140),_0x3ca649(0x173),_0x3ca649(0x139),'#f39c12',_0x3ca649(0x123),_0x3ca649(0x16b),_0x3ca649(0x192),_0x3ca649(0x176),_0x3ca649(0x15f),'getFullYear','drag-active',_0x3ca649(0x131),'√ÅREA','dragover',_0x3ca649(0x11a),'submit-iframe',_0x3ca649(0x17d),'slice','items','No\x20hay\x20datos\x20v√°lidos\x20en\x20el\x20archivo\x20Excel',_0x3ca649(0x169),'action',_0x3ca649(0x141),_0x3ca649(0x11e),_0x3ca649(0x162),_0x3ca649(0x179),'textContent',_0x3ca649(0x18a),_0x3ca649(0x114),_0x3ca649(0x134),'No\x20se\x20ha\x20seleccionado\x20ning√∫n\x20archivo',_0x3ca649(0x146),_0x3ca649(0x166),'30%',_0x3ca649(0x129),_0x3ca649(0x155),_0x3ca649(0x136),'append','Plantilla\x20PAC\x20descargada\x20exitosamente','status',_0x3ca649(0x116),'Formato\x20de\x20archivo\x20incorrecto',_0x3ca649(0x138),'_blank',_0x3ca649(0x10a),'addEventListener',_0x3ca649(0x186),'12872TVsPzt',_0x3ca649(0x1a0),_0x3ca649(0x15d),_0x3ca649(0x145),_0x3ca649(0x1a1),'Intentando\x20m√©todo\x20alternativo\x20de\x20env√≠o...','excelFile',_0x3ca649(0x12f),_0x3ca649(0x19f),'sheet_to_json','POST',_0x3ca649(0x16e),'aoa_to_sheet','uploadBtn',_0x3ca649(0x188),_0x3ca649(0x15e),_0x3ca649(0x171),_0x3ca649(0x130),_0x3ca649(0x14b),_0x3ca649(0x13f),_0x3ca649(0x1a4),_0x3ca649(0x14a),_0x3ca649(0x12d),'CUENTA\x20CONTABLE',_0x3ca649(0x107),_0x3ca649(0x17a),_0x3ca649(0x110),_0x3ca649(0x13c),_0x3ca649(0x143),_0x3ca649(0x17b),_0x3ca649(0x185)];return _0x6614=function(){return _0x10824f;},_0x6614();}function verificarEncabezados(_0x1b2b25){const _0xd663cd=_0x12dc55,_0x4735b2=_0x440c87,_0xab3eca=[_0x4735b2(0x127),_0x4735b2(0x100),_0x4735b2(0x139),_0x4735b2(0x102)],_0x27463c=_0x5c8778=>_0x5c8778['trim']()[_0x4735b2(0x104)](),_0x3939c0=_0x1b2b25[_0x4735b2(0xba)](_0x19d1be=>_0x27463c(_0x19d1be));return _0xab3eca[_0xd663cd(0x199)](_0x9eff2=>_0x3939c0[_0xd663cd(0x122)](_0x4b3947=>_0x4b3947[_0xd663cd(0x132)](_0x9eff2)));}function enviarDatos(_0x13f47b,_0x16d1f8,_0x2ac328,_0x4c4490){const _0x17ad30=_0x12dc55,_0x4ec67d=_0x440c87;fetch(WEB_APP_URL,{'method':_0x4ec67d(0x12d),'mode':_0x4ec67d(0xdf),'headers':{'Content-Type':'application/json'},'body':JSON[_0x17ad30(0x125)]({'pagina':_0x13f47b,'fila':_0x16d1f8,'datos':_0x2ac328,'tipo':_0x4c4490})})['then'](_0xf02b7b=>{const _0x1835a6=_0x4ec67d;console[_0x1835a6(0x118)](_0x1835a6(0xd4),_0xf02b7b);if(!_0xf02b7b['ok'])throw new Error(_0x1835a6(0x136)+_0xf02b7b[_0x1835a6(0x11b)]);return _0xf02b7b[_0x1835a6(0xff)]();})[_0x4ec67d(0xdd)](_0x7566d8=>{const _0xbdad65=_0x17ad30,_0x3abf8c=_0x4ec67d;console[_0x3abf8c(0x118)](_0xbdad65(0x115),_0x7566d8),mostrarToast(_0xbdad65(0x118),_0x3abf8c(0xbe)),window[_0x3abf8c(0xea)]({'top':0x0,'behavior':_0xbdad65(0x126)});})['catch'](_0x23ac2d=>{const _0x1d6a87=_0x4ec67d;console[_0x1d6a87(0x108)](_0x1d6a87(0x113),_0x23ac2d),enviarDatosAlternativo(_0x13f47b,_0x16d1f8,_0x2ac328,0x2);});}function enviarDatosAlternativo(_0x44f1f4,_0xc7583b,_0x50fc30,_0xf6748f){const _0x1ff922=_0x12dc55,_0x486862=_0x440c87;console['log'](_0x486862(0x128));const _0x39eaa7={'pagina':_0x44f1f4,'fila':_0xc7583b,'datos':_0x50fc30,'tipo':_0xf6748f},_0x2f776d=new FormData();_0x2f776d[_0x486862(0x119)](_0x486862(0x109),_0x1ff922(0x1a3)),_0x2f776d['append'](_0x486862(0x110),JSON[_0x486862(0xd8)](_0x39eaa7));const _0x40c07b=document[_0x486862(0x14a)]('iframe');_0x40c07b[_0x486862(0x111)]=_0x486862(0x103),_0x40c07b[_0x486862(0xb4)][_0x486862(0xe2)]='none',document[_0x486862(0x126)][_0x486862(0xc7)](_0x40c07b);const _0x4af638=document[_0x486862(0x14a)](_0x486862(0x146));_0x4af638[_0x486862(0xdc)]=_0x486862(0x12d),_0x4af638[_0x486862(0x109)]=WEB_APP_URL,_0x4af638[_0x1ff922(0x129)]=_0x486862(0x103);const _0x45fda4=document['createElement'](_0x486862(0xd1));_0x45fda4['type']=_0x486862(0xab),_0x45fda4[_0x486862(0x111)]=_0x486862(0x109),_0x45fda4[_0x486862(0xd5)]=_0x486862(0x148),_0x4af638[_0x486862(0xc7)](_0x45fda4);const _0x356a23=document[_0x486862(0x14a)](_0x486862(0xd1));_0x356a23[_0x1ff922(0x12c)]='hidden',_0x356a23[_0x486862(0x111)]=_0x1ff922(0x114),_0x356a23[_0x486862(0xd5)]=JSON[_0x486862(0xd8)](_0x39eaa7),_0x4af638[_0x486862(0xc7)](_0x356a23),document[_0x1ff922(0x145)][_0x486862(0xc7)](_0x4af638),mostrarToast(_0x486862(0xbc),_0x486862(0xf7)),_0x4af638[_0x486862(0x143)](),setTimeout(()=>{const _0x49b30c=_0x1ff922,_0x1d5fa3=_0x486862;document[_0x49b30c(0x145)][_0x1d5fa3(0x114)](_0x4af638),document[_0x1d5fa3(0x126)][_0x1d5fa3(0x114)](_0x40c07b),mostrarToast(_0x1d5fa3(0xb1),_0x49b30c(0x142));},0x7d0);}function handleProcessingError(_0x34d59e){const _0x459f41=_0x12dc55,_0x12053e=_0x440c87;console['error'](_0x459f41(0x165),_0x34d59e),document[_0x12053e(0xa2)](_0x12053e(0xd6))[_0x459f41(0x167)][_0x12053e(0xe2)]=_0x12053e(0xad),mostrarToast(_0x12053e(0xd0)+_0x34d59e[_0x12053e(0xcf)],_0x12053e(0xa7));}function _0x32fd(_0x469068,_0x56923d){const _0x282569=_0x6614();return _0x32fd=function(_0x6fe7c6,_0x5bf843){_0x6fe7c6=_0x6fe7c6-0xa2;let _0x5c02e0=_0x282569[_0x6fe7c6];return _0x5c02e0;},_0x32fd(_0x469068,_0x56923d);}function showUploadSuccess(){const _0x33f425=_0x12dc55,_0xae0c91=_0x440c87,_0x2eb185=document[_0xae0c91(0xa2)](_0xae0c91(0xa5)),_0x1c66e1=document[_0x33f425(0x16d)](_0xae0c91(0xc3));_0x2eb185[_0xae0c91(0xb4)][_0x33f425(0x15f)]=_0xae0c91(0xb5),setTimeout(()=>{const _0x43428a=_0xae0c91;_0x2eb185[_0x43428a(0xb4)][_0x43428a(0xfc)]=_0x43428a(0xe4);},0x3e8),_0x1c66e1[_0xae0c91(0x10e)]=_0xae0c91(0xf5),setTimeout(()=>{const _0x524397=_0x33f425,_0x46721c=_0xae0c91;_0x1c66e1[_0x524397(0x113)]=_0x46721c(0x138);},0xbb8);}function mostrarToast(_0x3efd37,_0x29ea70){const _0x12bd8d=_0x12dc55,_0x384276=_0x440c87,_0x5173f7=document[_0x384276(0xa2)](_0x12bd8d(0x111));_0x5173f7[_0x384276(0x10e)]=_0x3efd37,_0x5173f7[_0x384276(0xb4)][_0x384276(0xfc)]=_0x29ea70,_0x5173f7[_0x384276(0xb4)][_0x384276(0xec)]=_0x384276(0x137),_0x5173f7[_0x384276(0xb4)][_0x384276(0xa6)]='1',setTimeout(()=>{const _0x1e4643=_0x384276;_0x5173f7[_0x1e4643(0xb4)][_0x1e4643(0xa6)]='0',setTimeout(()=>{const _0x353a1e=_0x1874,_0x6a742b=_0x1e4643;_0x5173f7[_0x353a1e(0x167)][_0x6a742b(0xec)]=_0x6a742b(0xab);},0x12c);},0xbb8);}function resetFileInput(){const _0x14aa68=_0x12dc55,_0x56b5b7=_0x440c87;document[_0x56b5b7(0xa2)](_0x56b5b7(0x129))[_0x56b5b7(0xd5)]='',document[_0x56b5b7(0xa2)](_0x56b5b7(0x10c))[_0x56b5b7(0x10e)]=_0x14aa68(0x19e),document[_0x56b5b7(0xa2)](_0x56b5b7(0x130))[_0x56b5b7(0xb4)][_0x56b5b7(0xe2)]=_0x56b5b7(0xad);}function descargarPlantilla(){const _0x3ca10d=_0x12dc55,_0x548908=_0x440c87;try{mostrarToast(_0x548908(0xeb),_0x548908(0xaa));const _0x5c2dd1=XLSX[_0x548908(0xb0)][_0x548908(0x133)](),_0x79a9c7=[_0x548908(0x102),_0x548908(0x13a),_0x3ca10d(0x120),_0x548908(0x13e),_0x548908(0xd7),_0x548908(0xde),_0x548908(0x132),_0x3ca10d(0x15a),_0x548908(0xb8),_0x3ca10d(0x133),_0x548908(0xb9),_0x548908(0x145),_0x548908(0xbd),_0x548908(0xce),_0x548908(0xc6),_0x548908(0x149)],_0x18d377=[_0x79a9c7],_0x15f805=XLSX[_0x548908(0xb0)][_0x548908(0x12f)](_0x18d377);XLSX[_0x548908(0xb0)][_0x548908(0xf2)](_0x5c2dd1,_0x15f805,_0x3ca10d(0x18f)),XLSX[_0x548908(0xfb)](_0x5c2dd1,_0x548908(0xe3)),mostrarToast(_0x548908(0x11a),_0x548908(0xbe));}catch(_0x110871){console[_0x548908(0x108)](_0x548908(0x11c),_0x110871),mostrarToast(_0x548908(0xee)+_0x110871[_0x548908(0xcf)],'#e74c3c');}}function openAssistance(){const _0xf3e889=_0x440c87,_0x443b21=_0xf3e889(0x140);window[_0xf3e889(0xaf)](_0xf3e889(0xb7)+_0x443b21,_0xf3e889(0x11f));}
    </script>
    
</body>
</html>
